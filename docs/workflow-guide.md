# Energy Factory Backend - AI 워크플로우 가이드

## 개요
이 문서는 AI가 프로젝트 작업을 수행할 때 따라야 할 표준 워크플로우를 정의합니다.

## 표준 워크플로우

### 1. 작업 시작 전 준비사항
```
1. docs/task-history.md 파일을 읽고 프로젝트 현재 상태 파악
2. "현재 상태" 섹션에서 완료된 기능과 미완성 부분 확인
3. "다음 작업 예정" 섹션에서 우선순위 작업 확인
4. git log 및 git status로 최신 변경사항 확인
5. 관련 SSoT 문서/코드 확인:
   - 데이터 모델 작업 시: docs/erd.txt 확인
   - API 변경 시: 해당 Controller 먼저 확인
   - 설정 변경 시: application.yml 확인
```

### 2. 작업 계획 수립
```
1. TodoWrite 도구를 사용하여 작업 계획 작성
2. 큰 작업은 여러 단계로 세분화
3. 각 단계별 예상 소요시간 및 순서 정의
```

### 3. 작업 수행
```
1. 계획된 순서대로 작업 진행
2. 각 단계 완료 시 TodoWrite로 진행상황 업데이트
3. 코드 변경 시 기존 컨벤션 및 패턴 준수
4. 작업 중 발견된 이슈나 개선사항 기록
```

### 4. 작업 완료 후 문서화
```
1. task-history.md에 새로운 작업 이력 추가
2. 템플릿을 사용하여 상세 내용 기록
3. "현재 상태" 섹션 업데이트
4. "다음 작업 예정" 섹션 갱신
```

### 5. 커밋 및 마무리
```
1. 변경사항을 적절한 단위로 커밋
2. task-history.md에 커밋 정보 업데이트
3. 다음 작업자를 위한 인수인계 사항 정리
```

## 작업 이력 템플릿

### 새로운 작업 추가 시 사용할 템플릿:

```markdown
### YYYY-MM-DD - [작업 제목]

**작업 목적:** [작업을 수행한 배경과 목적]
**담당자:** AI Assistant
**소요시간:** [예상/실제 시간]

#### 작업 내용
- [구체적인 작업 항목 1]
- [구체적인 작업 항목 2]
- [구체적인 작업 항목 3]

#### 주요 변경사항
- `파일명.java`: [변경 내용]
- `파일명.java`: [변경 내용]

#### 기술적 의사결정
- **결정사항 1:** [선택한 방식과 그 이유]
- **결정사항 2:** [선택한 방식과 그 이유]

#### 커밋 정보
- **커밋 해시:** [해시값]
- **커밋 메시지:** [메시지]
- **변경된 파일:** [파일 목록]

#### 다음 작업 연계사항
- [후속 작업이 필요한 부분]
- [주의사항이나 고려사항]

---
```

## 코딩 컨벤션

### 1. Spring Boot 프로젝트 기본 규칙
- **패키지 구조:** `com.energyfactory.energy_factory.[layer]`
- **클래스명:** PascalCase
- **메서드명:** camelCase
- **상수:** UPPER_SNAKE_CASE

### 2. API 설계 원칙
- **REST API 규칙 준수**
- **ApiResponse 패턴 사용:** 모든 응답은 `ApiResponse<T>` 래핑
- **HTTP 상태코드 적절 사용**
- **RequestMapping 경로 일관성 유지**

### 3. Swagger 문서화 규칙
- **미니멀 패턴 적용:** `@Tag`, `@Operation(summary)` 만 사용
- **verbose 어노테이션 금지:** `@ApiResponses`, `@Parameter` 등 사용 안 함

### 4. SSoT (Single Source of Truth) 원칙

#### 4.1 데이터 모델링
- **ERD가 최우선 진실의 원천:** `docs/EnergyFactory_ERD.erd` 및 `docs/erd.txt` 기준
- **엔티티 설계 시 ERD 먼저 확인 후 구현**
- **ERD와 다른 구조 필요 시 ERD 업데이트 후 구현**

#### 4.2 API 스펙
- **Controller가 API 스펙의 진실의 원천**
- **DTO 구조는 Controller 메서드 시그니처 기준**
- **API 변경 시 Controller → Service → Repository 순서로 수정**

#### 4.3 비즈니스 규칙
- **Service 레이어가 비즈니스 로직의 진실의 원천**
- **동일한 비즈니스 로직 중복 구현 금지**
- **공통 비즈니스 로직은 별도 서비스로 분리**

#### 4.4 설정 및 상수
- **application.yml이 설정의 진실의 원천**
- **하드코딩된 값 금지, 모든 설정값은 application.yml에서 관리**
- **상수는 enum 또는 constants 클래스에서 중앙 관리**

#### 4.5 문서화
- **task-history.md가 프로젝트 상태의 진실의 원천**
- **모든 주요 의사결정과 변경사항은 task-history.md에 기록**
- **README.md는 프로젝트 개요만, 상세 내용은 task-history.md 참조**

### 4. 커밋 메시지 규칙
```
[타입] : [간단한 설명]

타입:
- feat: 새로운 기능 추가
- fix: 버그 수정  
- refactor: 코드 리팩토링
- docs: 문서 변경
- test: 테스트 코드
- chore: 빌드/설정 변경
```

## 주의사항

### 1. 필수 확인사항
- 작업 전 항상 `task-history.md` 읽기
- 기존 코드 패턴 및 컨벤션 준수
- 변경사항은 최소 단위로 커밋
- **SSoT 확인:** 관련 진실의 원천 문서/코드 먼저 확인

### 2. 금지사항
- task-history.md 읽지 않고 작업 시작 금지
- 기존 API 스펙 임의 변경 금지
- 큰 변경사항을 한 번에 커밋 금지
- **SSoT 위반:** 동일한 정보를 여러 곳에 중복 정의 금지
- **ERD 무시:** 데이터 모델 변경 시 ERD 확인 없이 진행 금지
- **하드코딩:** 설정값이나 상수를 코드에 직접 작성 금지

### 3. 권장사항
- 작업 계획을 TodoWrite로 명확히 수립
- 단계별 진행상황을 지속적으로 업데이트
- 기술적 의사결정의 근거를 명확히 기록
- **SSoT 준수:** 정보 변경 시 모든 관련 참조 위치 함께 업데이트
- **진실의 원천 명시:** 새로운 정보 추가 시 어느 것이 SSoT인지 명확히 정의

## 다음 작업자를 위한 인수인계

이 가이드를 따라 작업하면:
1. **연속성 보장:** 이전 작업 맥락을 정확히 파악 가능
2. **효율성 향상:** 중복 작업이나 혼선 방지
3. **품질 관리:** 일관된 코드 품질 및 문서화 유지
4. **지식 공유:** 기술적 의사결정 과정 투명하게 공유

각 작업 완료 후 반드시 `task-history.md`를 업데이트하여 다음 작업자가 원활하게 이어갈 수 있도록 합니다.